(function(h){var g,f={start:{x:0,y:0,time:0},delta:{prevPos:{x:0,y:0},dist:{x:0,y:0},dir:{x:0,y:0}},end:{duration:0,speed:{x:0,y:0},flick:{x:0,y:0}}},p=false,k=false,t="translate",i="",r="",w=0,c=0.7,u=5,n=false;var s={init:function(x){var y=h.extend({enableDebugger:false,segments:5,snapSpeed:0.3,flickSnapSpeed:0.3,flickThreshold:false,segmentPx:"auto",flickDirection:"auto",preventDefault:true,onCreate:false,onFlick:false,onFlickLeft:false,onFlickRight:false,onFlickUp:false,onFlickDown:false,onScroll:false,onScrollNext:false,onScrollPrev:false,onMove:false,onStart:false,onEnd:false},x);return this.each(function(){var A=h(this),C=A.data("isAlive");if(!C){var z=y.segments,B=b(A,y.flickDirection);A.data("isAlive",true).data("pos",0).data("snapSpeed",parseFloat(y.snapSpeed)).data("flickSnapSpeed",parseFloat(y.flickSnapSpeed)).data("segment",0).data("segments",z).data("flickDirection",B).data("segmentPx",m(A,y.segmentPx));h(A).on({onStart:function(){h(this).flickable("start",y.onStart)},onMove:function(){h(this).flickable("move",y.onMove)},onEnd:function(){h(this).flickable("finished",y.onEnd)},onScroll:function(){h(this).flickable("scrollToSegment",y.onScroll)},onScrollPrev:function(){h(this).flickable("prevSegment",y.onScrollPrev)},onScrollNext:function(){h(this).flickable("nextSegment",y.onScrollNext)},onFlick:function(){h(this).flickable("flick",y.onFlick)},onFlickLeft:function(){h(this).flickable("flickLeft",y.onFlickLeft)},onFlickRight:function(){h(this).flickable("flickRight",y.onFlickRight)},onFlickUp:function(){h(this).flickable("flickUp",y.onFlickUp)},onFlickDown:function(){h(this).flickable("flickDown",y.onFlickDown)},touchstart:function(D){q(D);h(this).trigger("onStart")},touchmove:function(D){if(y.preventDefault){D.preventDefault()}o(D);h(this).trigger("onMove")},touchend:function(D){j(D);h(this).trigger("onEnd")}});if(!l("transition")){p=true}if(l("translate3d")){k=true;t="translate3d"}i=e("transform");r=e("transition");if(parseInt(y.flickThreshold)){c=parseInt(y.flickThreshold)}if(n||y.enableDebugger){a()}A.flickable("create",y.onCreate)}else{if(y.segments=="auto"){y.segments=A.children().length;y.segmentPx="auto"}A.data("segments",y.segments).data("segmentPx",m(A,y.segmentPx));A.flickable("scrollToSegment")}})},create:function(y){var x=h(this);g=f;w++;d("It's alive!");if(!x.attr("id")){x.attr("id","flickable"+w)}x.flickable("scrollToSegment");if(typeof y=="function"){y.call(this,w)}},start:function(B){d("Touch start");var y=h(this),z=parseInt(y.data("segment")),A=parseInt(y.data("segmentPx")),x=-(A*z);y.data("anchor",x);if(typeof B=="function"){B.call(this,g)}},segment:function(x){var z=h(this),y=parseInt(z.data("segments")),A=parseInt(z.data("segment"));if(typeof x!="undefined"){if(x>=y){x=(y-1)}else{if(x<0){x=0}}if(x!==A){z.data("segment",x).trigger("onScroll")}else{z.flickable("scrollToSegment")}}return parseInt(z.data("segment"))},move:function(C){var z=h(this),B,y,A=z.data("flickDirection"),x=parseInt(z.data("anchor")),B=x+g.delta.dist[A];if(p){if(A=="y"){z.css("top",B)}else{z.css("left",B)}}else{if(k){(A=="y")?y="(0,"+B+"px,0)":y="("+B+"px,0,0)"}else{(A=="y")?y="(0,"+B+"px)":y="("+B+"px,0)"}z.css(i+"transform",t+y)}h(this).data("pos",B);if(typeof C=="function"){C.call(this,g)}},scrollNext:function(){h(this).trigger("onScrollNext")},scrollPrev:function(){h(this).trigger("onScrollPrev")},nextSegment:function(z){d("Next segment");var x=h(this),y=parseInt(x.data("segment"))+1;x.flickable("segment",y);if(typeof z=="function"){z.call(this,g,y)}},prevSegment:function(z){d("Previous segment");var x=h(this),y=parseInt(x.data("segment"))-1;x.flickable("segment",y);if(typeof z=="function"){z.call(this,g,y)}},flick:function(y){d("You flicked");var x=h(this);switch(g.end.flick.x){case -1:x.trigger("onFlickLeft");break;case 1:x.trigger("onFlickRight");break}switch(g.end.flick.y){case -1:x.trigger("onFlickUp");break;case 1:x.trigger("onFlickDown");break}if(typeof y=="function"){y.call(this,g)}},flickLeft:function(z){d("Flicked left");var x=h(this),y=parseInt(x.data("segment"));x.trigger("onScrollNext");if(typeof z=="function"){z.call(this,g,y)}},flickRight:function(z){d("Flicked right");var x=h(this),y=parseInt(x.data("segment"));x.trigger("onScrollPrev");if(typeof z=="function"){z.call(this,g,y)}},flickUp:function(z){d("Flicked up");var x=h(this),y=parseInt(x.data("segment"));x.trigger("onScrollNext");if(typeof z=="function"){z.call(this,g,y)}},flickDown:function(z){d("Flicked down");var x=h(this),y=parseInt(x.data("segment"));x.trigger("onScrollPrev");if(typeof z=="function"){z.call(this,g,y)}},scrollToSegment:function(I){var z=h(this),x,D={},F=z.data("flickDirection"),y=parseFloat(z.data("snapSpeed")),A=parseFloat(z.data("flickSnapSpeed")),B=parseInt(z.data("segments")),C=parseInt(z.data("segment")),G=parseInt(z.data("segmentPx")),H=-(G*C),E="ease-out";d("Sliding to segment "+C);if(g.end.flick.x||g.end.flick.y){y=A;E="cubic-bezier(0, .70, .35, 1)"}z.data("anchor",H).data("pos",H).data("segment",C);if(p){if(F=="y"){z.css("position","relative");z.animate({top:H},y*1000)}else{z.css("position","relative");z.animate({left:H},y*1000)}}else{if(k){(F=="y")?x="(0, "+H+"px, 0)":x="("+H+"px, 0, 0)"}else{(F=="y")?x="(0, "+H+"px)":x="("+H+"px, 0)"}D[i+"transform"]=t+x;D[r+"transition-property"]=i+"transform";D[r+"transition-duration"]=y+"s";D[r+"transition-timing-function"]=E;z.css(D);setTimeout(function(){z.css(r+"transition","")},y*1000)}if(typeof I=="function"){I.call(this,g,C)}},finished:function(F){var x=h(this),B=x.data("flickDirection"),z=parseInt(x.data("segments")),A=parseInt(x.data("segment")),C=parseInt(x.data("segmentPx")),y=parseInt(x.data("anchor")),E=parseInt(x.data("pos"));var D;(E<0)?D=Math.abs(Math.round(E/C)):D=0;d("Nearest segment is "+D);if(typeof F=="function"){F.call(this,g,A)}if(A==D){if(g.end.flick[B]){return x.trigger("onFlick")}}if(D==(A+1)){x.trigger("onScrollNext")}else{if(D==(A-1)){x.trigger("onScrollPrev")}else{x.flickable("segment",D)}}}};h.fn.flickable=function(x){if(s[x]){return s[x].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof x==="object"||!x){return s.init.apply(this,arguments)}else{h.error("Method "+x+" does not exist")}}};function q(z){var y,x;z=(typeof z.originalEvent!="undefined")?z.originalEvent:z;(typeof z.touches[0].pageX!="undefined")?y=z.touches[0].pageX:y=z.pageX;(typeof z.touches[0].pageY!="undefined")?x=z.touches[0].pageY:x=z.pageY;g=f;g.start={x:y,y:x,time:z.timeStamp};g.delta.prevPos={x:y,y:x};o(z);if(n){v()}}function o(C){var A,z;C=(typeof C.originalEvent!="undefined")?C.originalEvent:C;(typeof C.touches[0].pageX!="undefined")?A=C.touches[0].pageX:A=C.pageX;(typeof C.touches[0].pageY!="undefined")?z=C.touches[0].pageY:z=C.pageY;var y,x,D=A,B=z,F=A-g.start.x,E=z-g.start.y;if(A>g.delta.prevPos.x){y=1}else{if(A<g.delta.prevPos.x){y=-1}else{y=0}}if(z>g.delta.prevPos.y){x=1}else{if(z<g.delta.prevPos.y){x=-1}else{x=0}}g.delta.prevPos={x:D,y:B};g.delta.dist={x:F,y:E};g.delta.dir={x:y,y:x};if(n){v()}}function j(E){var D=(E.timeStamp-g.start.time),C=Math.abs(Math.round(g.delta.dist.x/D*100)/100),B=Math.abs(Math.round(g.delta.dist.y/D*100)/100),y=g.delta.dir.x,x=g.delta.dir.y,A=0,z=0;if((C>c)){(Math.abs(g.delta.dist.x)>=u)?A=y:A=0}else{if((B>c)){(Math.abs(g.delta.dist.y)>=u)?z=x:z=0}}g.end.duration=D;g.end.speed={x:C,y:B};g.end.flick={x:A,y:z};if(n){d("Touch end");v()}}function b(x,y){if((y!=="x")&&(y!=="y")){(x.height()>x.width())?y="y":y="x"}return y}function m(A,C){if(!parseInt(C)){var C,y=A.data("segments"),B=b(A,A.data("flickDirection")),z=0,x=0;A.children().each(function(){z+=h(this).outerWidth(true)});A.children().each(function(){x+=h(this).outerHeight(true)});(B=="y")?C=x/y:C=z/y}return C}function l(y){var x={translate3d:function(){return("WebKitCSSMatrix" in window&&"m11" in new WebKitCSSMatrix())},transition:function(){return(e("transition")==false)?false:true}};if(x[y]){return x[y].apply(this,Array.prototype.slice.call(arguments,1))}else{h.error("Method"+y+" does not exist on jQuery.flickable")}}function e(z){var y=document.createElement("div"),x=y.style;prefixs=["Webkit","Moz","O","ms"];return(function(){if(z in y.style){return""}z=z.charAt(0).toUpperCase()+z.slice(1);for(var A in prefixs){if(prefixs[A]+z in y.style){return"-"+prefixs[A].charAt(0).toLowerCase()+prefixs[A].slice(1)+"-"}}return false})()}function a(){if(!h("#flickableDebugger").length){n=true;g=f;g.eventLog=[];var x='<div id="flickableDebugger" style="position: fixed; bottom: 0; margin: 0 auto; padding: 10px; width: 100%; background: #000; color: #fff; font-family: courier, sans-serif;">Debugger</div>';h("body").append(x)}}function d(x){if(n){console.log(x);g.eventLog.splice(0,0,x);v()}}function v(){var y="";for(var x=0;x<3;x++){y+=g.eventLog[x]+" | "}var z="<pre> 		last 3 events: "+y+"<br /> 		start: {x:"+g.start.x+", y:"+g.start.y+",time: "+g.start.time+"}<br /> 			delta: {<br /> 			prevPos: {"+g.delta.prevPos.x+", "+g.delta.prevPos.y+"}<br /> 			dist: {"+g.delta.dist.x+", "+g.delta.dist.y+"}<br /> 			dir: {"+g.delta.dir.x+", "+g.delta.dir.y+"}<br /> 			}<br /> 		end: {<br /> 			speed: {"+g.end.speed.x+", "+g.end.speed.y+"}<br /> 			flick: {"+g.end.flick.x+", "+g.end.flick.y+"}<br /> 			duration: "+g.end.duration+"<br /> 		} 		</pre>";h("#flickableDebugger").html(z)}})(jQuery);